<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>名字竞技场 接口测试</title>
<style type="text/css">
html {
 width:100%;
 height:100%;

}
body {
 margin: 0;
 font-size: 15px;
 width:100%;
 height:100%;
 font-family: "Microsoft YaHei", Consolas, Menlo, Monaco, "Lucida Console", "Liberation Mono", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Courier New", monospace, serif;
}
* {
 box-sizing: border-box;
}
.main{
display: flex;
flex-direction: row;
width:100%;
height:100%;
}

.left{
width:200px;
}
.left > * {
	margin:8px;
}

iframe{
flex: 1 1 auto;
width:100%;
height:100%;
}
textarea{
min-height: 150px;
}

</style>

<script type="text/javascript">

function run(){
	var names = document.querySelector('textarea').value;
	var base64 = window.btoa(unescape(encodeURIComponent(names))).replace(/\+/g,'-').replace(/\//g,'_');
	document.querySelector('iframe').src = 'https://namerena.github.io/#n=' + base64;
}
	
function test(){
	var names = "!test!\n!\n" + document.querySelector('textarea').value;
	var base64 = window.btoa(unescape(encodeURIComponent(names))).replace(/\+/g,'-').replace(/\//g,'_');
	document.querySelector('iframe').src = 'https://namerena.github.io/#n=' + base64;
}
function onMessage(e) {
	console.log(JSON.stringify(e.data, null, ' '));
	document.querySelector('textarea[readonly]').value = e.data.winners.join('\n');
	if (e.data.all[0][0]==e.data.winners[0]){/*单人对战，胜者在前排序入result */
		result=[e.data.all[0][0],e.data.all[1][0]];
	}else if (e.data.all[1][0]==e.data.winners[0]){
		result=[e.data.all[1][0],e.data.all[0][0]];
	}
	
		
}

	
window.addEventListener('message', onMessage);
</script>
</head>
<body>

<div class='main'>
	<div class='left'>
		<div>输入名字（输入）</div>
		<textarea></textarea>
		<button onclick="run()">开始</button>
		<button onclick="test()">测试模式</button>
		<div>胜利者（输出）</div>
		<textarea readonly></textarea>
		
	</div>
	<iframe></iframe>
</div>
</body>
</html>
